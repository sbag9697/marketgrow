<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section h2 {
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #5a67d8;
        }
        .result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 14px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        input {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 200px;
        }
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>ğŸ” ë¡œê·¸ì¸ ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</h1>

    <!-- API ì—°ê²° í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
        <h2>1. API ì—°ê²° í…ŒìŠ¤íŠ¸</h2>
        <button onclick="testAPIConnection()">API ì—°ê²° í™•ì¸</button>
        <div id="api-result" class="result"></div>
    </div>

    <!-- ë°ëª¨ ëª¨ë“œ í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
        <h2>2. ë°ëª¨ ëª¨ë“œ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</h2>
        <p>ë°ëª¨ ê³„ì •: <code>demo</code> / <code>Demo1234!</code></p>
        <button onclick="testDemoLogin()">ë°ëª¨ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</button>
        <div id="demo-result" class="result"></div>
    </div>

    <!-- ì§ì ‘ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸ -->
    <div class="test-section">
        <h2>3. ì§ì ‘ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸</h2>
        <div>
            <input type="text" id="test-username" placeholder="ì•„ì´ë””" value="demo">
            <input type="password" id="test-password" placeholder="ë¹„ë°€ë²ˆí˜¸" value="Demo1234!">
            <br>
            <button onclick="testDirectLogin()">ì§ì ‘ ë¡œê·¸ì¸</button>
        </div>
        <div id="direct-result" class="result"></div>
    </div>

    <!-- ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í™•ì¸ -->
    <div class="test-section">
        <h2>4. ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ìƒíƒœ</h2>
        <button onclick="checkLocalStorage()">ìŠ¤í† ë¦¬ì§€ í™•ì¸</button>
        <button onclick="clearLocalStorage()">ìŠ¤í† ë¦¬ì§€ ì´ˆê¸°í™”</button>
        <div id="storage-result" class="result"></div>
    </div>

    <!-- ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ í™•ì¸ -->
    <div class="test-section">
        <h2>5. ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ìƒíƒœ</h2>
        <button onclick="checkScripts()">ìŠ¤í¬ë¦½íŠ¸ í™•ì¸</button>
        <div id="script-result" class="result"></div>
    </div>

    <script>
        // API ì—°ê²° í…ŒìŠ¤íŠ¸
        async function testAPIConnection() {
            const resultDiv = document.getElementById('api-result');
            resultDiv.innerHTML = 'í…ŒìŠ¤íŠ¸ ì¤‘...';
            
            try {
                // Railway API í…ŒìŠ¤íŠ¸
                const railwayResponse = await fetch('https://marketgrow-production.up.railway.app/api/health');
                const railwayData = await railwayResponse.json();
                
                resultDiv.className = 'result success';
                resultDiv.innerHTML = `
                    âœ… Railway API ì—°ê²° ì„±ê³µ!<br>
                    Status: ${railwayData.status}<br>
                    Environment: ${railwayData.environment}<br>
                    Timestamp: ${railwayData.timestamp}
                `;
            } catch (error) {
                resultDiv.className = 'result error';
                resultDiv.innerHTML = `âŒ API ì—°ê²° ì‹¤íŒ¨: ${error.message}`;
            }
        }

        // ë°ëª¨ ëª¨ë“œ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
        function testDemoLogin() {
            const resultDiv = document.getElementById('demo-result');
            
            // ê°„ë‹¨í•œ ë°ëª¨ ì¸ì¦
            const demoAuth = {
                username: 'demo',
                password: 'Demo1234!',
                token: 'demo_token_' + Date.now()
            };
            
            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
            localStorage.setItem('authToken', demoAuth.token);
            localStorage.setItem('userInfo', JSON.stringify({
                username: demoAuth.username,
                email: 'demo@test.com',
                name: 'ë°ëª¨ ì‚¬ìš©ì'
            }));
            localStorage.setItem('demoMode', 'true');
            
            resultDiv.className = 'result success';
            resultDiv.innerHTML = `
                âœ… ë°ëª¨ ë¡œê·¸ì¸ ì„±ê³µ!<br>
                Token: ${demoAuth.token}<br>
                Username: ${demoAuth.username}<br>
                <button onclick="window.location.href='dashboard.html'">ëŒ€ì‹œë³´ë“œë¡œ ì´ë™</button>
            `;
        }

        // ì§ì ‘ ë¡œê·¸ì¸ í…ŒìŠ¤íŠ¸
        async function testDirectLogin() {
            const resultDiv = document.getElementById('direct-result');
            const username = document.getElementById('test-username').value;
            const password = document.getElementById('test-password').value;
            
            resultDiv.innerHTML = 'ë¡œê·¸ì¸ ì‹œë„ ì¤‘...';
            
            try {
                // Railway APIë¡œ ë¡œê·¸ì¸ ì‹œë„
                const response = await fetch('https://marketgrow-production.up.railway.app/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        login: username,
                        password: password
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    resultDiv.className = 'result success';
                    resultDiv.innerHTML = `
                        âœ… ë¡œê·¸ì¸ ì„±ê³µ!<br>
                        Message: ${data.message}<br>
                        User: ${data.data.user.username}
                    `;
                } else {
                    throw new Error(data.message || 'ë¡œê·¸ì¸ ì‹¤íŒ¨');
                }
            } catch (error) {
                // API ì‹¤íŒ¨ ì‹œ ë°ëª¨ ëª¨ë“œë¡œ í´ë°±
                if (username === 'demo' && password === 'Demo1234!') {
                    testDemoLogin();
                    resultDiv.className = 'result info';
                    resultDiv.innerHTML += '<br>âš ï¸ API ì˜¤ë¥˜ë¡œ ë°ëª¨ ëª¨ë“œë¡œ ì „í™˜ë¨';
                } else {
                    resultDiv.className = 'result error';
                    resultDiv.innerHTML = `âŒ ë¡œê·¸ì¸ ì‹¤íŒ¨: ${error.message}`;
                }
            }
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ í™•ì¸
        function checkLocalStorage() {
            const resultDiv = document.getElementById('storage-result');
            
            const authToken = localStorage.getItem('authToken');
            const userInfo = localStorage.getItem('userInfo');
            const demoMode = localStorage.getItem('demoMode');
            
            resultDiv.className = 'result info';
            resultDiv.innerHTML = `
                <strong>ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ìƒíƒœ:</strong><br>
                authToken: ${authToken ? 'âœ… ìˆìŒ (' + authToken.substring(0, 20) + '...)' : 'âŒ ì—†ìŒ'}<br>
                userInfo: ${userInfo ? 'âœ… ìˆìŒ' : 'âŒ ì—†ìŒ'}<br>
                demoMode: ${demoMode ? 'âœ… ' + demoMode : 'âŒ ì—†ìŒ'}<br>
                ${userInfo ? '<br>ì‚¬ìš©ì ì •ë³´: ' + userInfo : ''}
            `;
        }

        // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ ì´ˆê¸°í™”
        function clearLocalStorage() {
            localStorage.removeItem('authToken');
            localStorage.removeItem('userInfo');
            localStorage.removeItem('demoMode');
            
            const resultDiv = document.getElementById('storage-result');
            resultDiv.className = 'result success';
            resultDiv.innerHTML = 'âœ… ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.';
        }

        // ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ í™•ì¸
        function checkScripts() {
            const resultDiv = document.getElementById('script-result');
            
            const scripts = {
                'API_CONFIG': typeof API_CONFIG !== 'undefined',
                'API Class': typeof API !== 'undefined',
                'DemoAuth': typeof DemoAuth !== 'undefined',
                'NotificationManager': typeof NotificationManager !== 'undefined',
                'LoadingManager': typeof LoadingManager !== 'undefined'
            };
            
            let html = '<strong>ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ìƒíƒœ:</strong><br>';
            for (const [name, loaded] of Object.entries(scripts)) {
                html += `${name}: ${loaded ? 'âœ… ë¡œë“œë¨' : 'âŒ ì—†ìŒ'}<br>`;
            }
            
            resultDiv.className = 'result info';
            resultDiv.innerHTML = html;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì²´í¬
        window.onload = function() {
            console.log('í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
            checkScripts();
        };
    </script>
</body>
</html>