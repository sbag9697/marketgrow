<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë””ë²„ê·¸ ì¶”ì </title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #00ff00;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            margin: 5px;
            cursor: pointer;
        }
        .log {
            background: #000;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #00ff00;
            max-height: 500px;
            overflow-y: auto;
        }
        .error { color: #ff0000; }
        .success { color: #00ff00; }
        .warning { color: #ffff00; }
        .info { color: #00ffff; }
    </style>
</head>
<body>
    <h1>ğŸ” ë””ë²„ê·¸ ì¶”ì  ë„êµ¬</h1>
    
    <button onclick="traceAll()">ëª¨ë“  í•¨ìˆ˜ ì¶”ì </button>
    <button onclick="findMessageSource()">ë©”ì‹œì§€ ì†ŒìŠ¤ ì°¾ê¸°</button>
    <button onclick="overrideNotifications()">ì•Œë¦¼ ì˜¤ë²„ë¼ì´ë“œ</button>
    <button onclick="clearAll()">ì´ˆê¸°í™”</button>
    <button onclick="window.location.href='signup.html'">íšŒì›ê°€ì… í˜ì´ì§€</button>
    
    <div class="log" id="log"></div>
    
    <script>
        const log = document.getElementById('log');
        let logContent = [];
        
        function addLog(msg, type = 'info') {
            const time = new Date().toLocaleTimeString();
            const entry = `<div class="${type}">[${time}] ${msg}</div>`;
            logContent.push(entry);
            log.innerHTML = logContent.join('');
            log.scrollTop = log.scrollHeight;
        }
        
        function traceAll() {
            addLog('=== í•¨ìˆ˜ ì¶”ì  ì‹œì‘ ===', 'success');
            
            // localStorage ê²€ì‚¬
            addLog('--- LocalStorage ê²€ì‚¬ ---', 'info');
            for (let key in localStorage) {
                if (key.toLowerCase().includes('mock') || 
                    key.toLowerCase().includes('test') ||
                    key === 'useMockServer') {
                    addLog(`localStorage.${key} = ${localStorage[key]}`, 'warning');
                }
            }
            
            // window ê°ì²´ ê²€ì‚¬
            addLog('--- Window ê°ì²´ ê²€ì‚¬ ---', 'info');
            if (window.mockAPI) {
                addLog('window.mockAPIê°€ ì¡´ì¬í•¨!', 'error');
            }
            if (window.MockAPI) {
                addLog('window.MockAPI í´ë˜ìŠ¤ê°€ ì¡´ì¬í•¨!', 'error');
            }
            if (window.phoneAuthManager) {
                addLog('window.phoneAuthManagerê°€ ì¡´ì¬í•¨', 'info');
            }
            
            // verifyPhone í•¨ìˆ˜ ê²€ì‚¬
            addLog('--- verifyPhone í•¨ìˆ˜ ê²€ì‚¬ ---', 'info');
            if (window.verifyPhone) {
                const funcStr = window.verifyPhone.toString();
                if (funcStr.includes('123456') || funcStr.includes('í…ŒìŠ¤íŠ¸')) {
                    addLog('verifyPhoneì— í…ŒìŠ¤íŠ¸ ì½”ë“œ ë°œê²¬!', 'error');
                    addLog(funcStr.substring(0, 500), 'warning');
                } else {
                    addLog('verifyPhone í•¨ìˆ˜ëŠ” ì •ìƒ', 'success');
                }
            }
            
            // NotificationManager ê²€ì‚¬
            if (window.NotificationManager) {
                addLog('--- NotificationManager ê²€ì‚¬ ---', 'info');
                const original = window.NotificationManager.show;
                window.NotificationManager.show = function(message, type) {
                    addLog(`NotificationManager.show í˜¸ì¶œ: "${message}"`, 'warning');
                    console.trace('í˜¸ì¶œ ìŠ¤íƒ:');
                    return original.call(this, message, type);
                };
                addLog('NotificationManager.show í•¨ìˆ˜ í›„í‚¹ ì™„ë£Œ', 'success');
            }
            
            // alert ì˜¤ë²„ë¼ì´ë“œ
            const originalAlert = window.alert;
            window.alert = function(msg) {
                addLog(`alert í˜¸ì¶œ: "${msg}"`, 'error');
                console.trace('Alert í˜¸ì¶œ ìŠ¤íƒ:');
                return originalAlert(msg);
            };
            addLog('alert í•¨ìˆ˜ í›„í‚¹ ì™„ë£Œ', 'success');
            
            addLog('=== ì¶”ì  ì™„ë£Œ ===', 'success');
        }
        
        function findMessageSource() {
            addLog('=== ë©”ì‹œì§€ ì†ŒìŠ¤ ê²€ìƒ‰ ===', 'success');
            
            // ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ íƒœê·¸ ê²€ì‚¬
            const scripts = document.getElementsByTagName('script');
            for (let script of scripts) {
                if (script.src) {
                    addLog(`ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œë¨: ${script.src}`, 'info');
                    if (script.src.includes('mock') || script.src.includes('test')) {
                        addLog(`âš ï¸ ì˜ì‹¬ ìŠ¤í¬ë¦½íŠ¸: ${script.src}`, 'error');
                    }
                }
            }
            
            // ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ ê²€ì‚¬
            for (let script of scripts) {
                if (!script.src && script.textContent) {
                    if (script.textContent.includes('123456') || 
                        script.textContent.includes('í…ŒìŠ¤íŠ¸')) {
                        addLog('ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ë°œê²¬!', 'error');
                        addLog(script.textContent.substring(0, 200), 'warning');
                    }
                }
            }
            
            addLog('=== ê²€ìƒ‰ ì™„ë£Œ ===', 'success');
        }
        
        function overrideNotifications() {
            addLog('=== ì•Œë¦¼ ì‹œìŠ¤í…œ ì˜¤ë²„ë¼ì´ë“œ ===', 'success');
            
            // ìƒˆë¡œìš´ NotificationManager ìƒì„±
            window.NotificationManager = {
                show: function(message, type) {
                    addLog(`[ì°¨ë‹¨ë¨] ${type}: ${message}`, 'warning');
                    if (message.includes('í…ŒìŠ¤íŠ¸') || message.includes('123456')) {
                        addLog('í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì°¨ë‹¨!', 'error');
                        console.trace('í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ì†ŒìŠ¤:');
                        return;
                    }
                    // í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ê°€ ì•„ë‹ˆë©´ í‘œì‹œ
                    console.log(`[${type}] ${message}`);
                },
                success: function(msg) { this.show(msg, 'success'); },
                error: function(msg) { this.show(msg, 'error'); },
                info: function(msg) { this.show(msg, 'info'); },
                warning: function(msg) { this.show(msg, 'warning'); }
            };
            
            addLog('NotificationManager ì™„ì „ êµì²´ ì™„ë£Œ', 'success');
        }
        
        function clearAll() {
            // localStorage ì™„ì „ ì •ë¦¬
            localStorage.clear();
            sessionStorage.clear();
            
            // ëª¨ë“  mock ê´€ë ¨ ì œê±°
            delete window.mockAPI;
            delete window.MockAPI;
            
            addLog('ëª¨ë“  ë°ì´í„° ì‚­ì œ ì™„ë£Œ', 'success');
        }
        
        // ìë™ ì‹¤í–‰
        window.addEventListener('DOMContentLoaded', () => {
            addLog('í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ', 'success');
            traceAll();
        });
    </script>
</body>
</html>