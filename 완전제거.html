<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì™„ì „ ì œê±°</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
            max-width: 800px;
            width: 100%;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 32px;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 16px;
        }
        
        .status-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .status-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 8px;
            border-left: 4px solid #dee2e6;
        }
        
        .status-item.clean {
            border-left-color: #28a745;
        }
        
        .status-item.dirty {
            border-left-color: #dc3545;
            background: #fff5f5;
        }
        
        .status-label {
            font-weight: 600;
            color: #495057;
        }
        
        .status-value {
            font-family: monospace;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .status-value.clean {
            background: #d4edda;
            color: #155724;
        }
        
        .status-value.dirty {
            background: #f8d7da;
            color: #721c24;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 30px;
        }
        
        button {
            flex: 1;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: #0a4d3c;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .log-output {
            background: #1e1e1e;
            color: #00ff00;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }
        
        .log-output.show {
            display: block;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .success-message {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 18px;
            font-weight: 600;
            display: none;
            margin-top: 20px;
        }
        
        .success-message.show {
            display: block;
            animation: slideInUp 0.5s ease;
        }
        
        @keyframes slideInUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì™„ì „ ì œê±°</h1>
        <p class="subtitle">ëª¨ë“  Mock ë° í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì™„ì „íˆ ì œê±°í•©ë‹ˆë‹¤</p>
        
        <div class="status-card">
            <h3 style="margin-bottom: 15px;">ğŸ“Š í˜„ì¬ ìƒíƒœ</h3>
            <div id="statusList">
                <div class="spinner"></div>
            </div>
        </div>
        
        <div class="btn-group">
            <button class="btn-danger" onclick="executeComplete()">
                ğŸš€ ì™„ì „ ì œê±° ì‹¤í–‰
            </button>
            <button class="btn-primary" onclick="checkStatus()">
                ğŸ” ìƒíƒœ ë‹¤ì‹œ í™•ì¸
            </button>
            <button class="btn-success" onclick="goToSignup()">
                âœ… íšŒì›ê°€ì… í…ŒìŠ¤íŠ¸
            </button>
        </div>
        
        <div class="log-output" id="logOutput"></div>
        <div class="success-message" id="successMessage"></div>
    </div>

    <script>
        let logMessages = [];
        
        function addLog(message) {
            const timestamp = new Date().toLocaleTimeString();
            logMessages.push(`[${timestamp}] ${message}`);
            const logOutput = document.getElementById('logOutput');
            logOutput.classList.add('show');
            logOutput.innerHTML = logMessages.join('<br>');
            logOutput.scrollTop = logOutput.scrollHeight;
        }
        
        function checkStatus() {
            const statusList = document.getElementById('statusList');
            statusList.innerHTML = '<div class="spinner"></div>';
            
            setTimeout(() => {
                const checks = [
                    {
                        label: 'localStorage.useMockServer',
                        value: localStorage.getItem('useMockServer'),
                        expected: null
                    },
                    {
                        label: 'localStorage.mockMode',
                        value: localStorage.getItem('mockMode'),
                        expected: null
                    },
                    {
                        label: 'localStorage.testMode',
                        value: localStorage.getItem('testMode'),
                        expected: null
                    },
                    {
                        label: 'localStorage.mockUsers',
                        value: localStorage.getItem('mockUsers'),
                        expected: null
                    },
                    {
                        label: 'localStorage.mockOrders',
                        value: localStorage.getItem('mockOrders'),
                        expected: null
                    },
                    {
                        label: 'window.mockAPI',
                        value: typeof window.mockAPI !== 'undefined' ? 'exists' : null,
                        expected: null
                    },
                    {
                        label: 'sessionStorage (items)',
                        value: sessionStorage.length > 0 ? sessionStorage.length : null,
                        expected: null
                    }
                ];
                
                statusList.innerHTML = '';
                let hasIssues = false;
                
                checks.forEach(check => {
                    const isClean = check.value === check.expected;
                    if (!isClean) hasIssues = true;
                    
                    const item = document.createElement('div');
                    item.className = `status-item ${isClean ? 'clean' : 'dirty'}`;
                    item.innerHTML = `
                        <span class="status-label">${check.label}</span>
                        <span class="status-value ${isClean ? 'clean' : 'dirty'}">
                            ${check.value === null ? 'âœ… ì—†ìŒ' : `âš ï¸ ${check.value}`}
                        </span>
                    `;
                    statusList.appendChild(item);
                });
                
                if (!hasIssues) {
                    const successMsg = document.getElementById('successMessage');
                    successMsg.innerHTML = 'ğŸ‰ ëª¨ë“  í…ŒìŠ¤íŠ¸ ëª¨ë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤!';
                    successMsg.classList.add('show');
                }
            }, 500);
        }
        
        function executeComplete() {
            logMessages = [];
            addLog('=== í…ŒìŠ¤íŠ¸ ëª¨ë“œ ì™„ì „ ì œê±° ì‹œì‘ ===');
            
            // 1. localStorage ì™„ì „ ì •ë¦¬
            addLog('1ë‹¨ê³„: localStorage ì •ë¦¬ ì¤‘...');
            const keysToRemove = [
                'useMockServer',
                'mockMode',
                'testMode',
                'mockUsers',
                'mockOrders',
                'mockData',
                'enableMock',
                'verificationCodes',
                'testVerificationCode'
            ];
            
            keysToRemove.forEach(key => {
                if (localStorage.getItem(key) !== null) {
                    localStorage.removeItem(key);
                    addLog(`  âœ… localStorage.${key} ì œê±°ë¨`);
                }
            });
            
            // 2. mock ê´€ë ¨ ëª¨ë“  í‚¤ ì œê±°
            addLog('2ë‹¨ê³„: Mock ê´€ë ¨ ëª¨ë“  ë°ì´í„° ê²€ìƒ‰ ë° ì œê±°...');
            const allKeys = Object.keys(localStorage);
            allKeys.forEach(key => {
                if (key.toLowerCase().includes('mock') || 
                    key.toLowerCase().includes('test') ||
                    key.toLowerCase().includes('demo')) {
                    localStorage.removeItem(key);
                    addLog(`  âœ… localStorage.${key} ì¶”ê°€ ì œê±°ë¨`);
                }
            });
            
            // 3. sessionStorage ì™„ì „ ì´ˆê¸°í™”
            addLog('3ë‹¨ê³„: sessionStorage ì´ˆê¸°í™”...');
            const sessionCount = sessionStorage.length;
            sessionStorage.clear();
            addLog(`  âœ… sessionStorage ${sessionCount}ê°œ í•­ëª© ì œê±°ë¨`);
            
            // 4. window ê°ì²´ ì •ë¦¬
            addLog('4ë‹¨ê³„: window ê°ì²´ ì •ë¦¬...');
            if (window.mockAPI) {
                delete window.mockAPI;
                addLog('  âœ… window.mockAPI ì œê±°ë¨');
            }
            
            if (window.MockAPI) {
                delete window.MockAPI;
                addLog('  âœ… window.MockAPI í´ë˜ìŠ¤ ì œê±°ë¨');
            }
            
            // 5. ì¿ í‚¤ í™•ì¸ ë° ì œê±°
            addLog('5ë‹¨ê³„: Mock ê´€ë ¨ ì¿ í‚¤ ì œê±°...');
            document.cookie.split(";").forEach(function(c) { 
                if (c.trim().toLowerCase().includes('mock') || c.trim().toLowerCase().includes('test')) {
                    document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/");
                    addLog(`  âœ… ì¿ í‚¤ ì œê±°ë¨: ${c.split('=')[0]}`);
                }
            });
            
            // 6. ìºì‹œ ë²„ìŠ¤íŒ…
            addLog('6ë‹¨ê³„: ìºì‹œ ë¬´íš¨í™” ì„¤ì •...');
            localStorage.setItem('cacheVersion', Date.now().toString());
            addLog('  âœ… ìºì‹œ ë²„ì „ ì—…ë°ì´íŠ¸ë¨');
            
            addLog('=== ì œê±° ì™„ë£Œ ===');
            addLog('');
            addLog('âœ¨ ëª¨ë“  í…ŒìŠ¤íŠ¸ ë° Mock ë°ì´í„°ê°€ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤!');
            addLog('âœ¨ ì´ì œ ì‹¤ì œ APIë§Œ ì‚¬ìš©ë©ë‹ˆë‹¤.');
            
            // ìƒíƒœ ì¬í™•ì¸
            setTimeout(() => {
                checkStatus();
            }, 1000);
        }
        
        function goToSignup() {
            // ë§ˆì§€ë§‰ìœ¼ë¡œ í•œë²ˆ ë” ì •ë¦¬
            localStorage.removeItem('useMockServer');
            localStorage.removeItem('mockMode');
            localStorage.removeItem('testMode');
            
            // ê°•ì œ ìºì‹œ ë¬´íš¨í™”ë¥¼ ìœ„í•œ íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ê°€
            const timestamp = Date.now();
            window.location.href = `signup.html?_t=${timestamp}`;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìƒíƒœ í™•ì¸
        window.addEventListener('DOMContentLoaded', () => {
            checkStatus();
        });
    </script>
</body>
</html>